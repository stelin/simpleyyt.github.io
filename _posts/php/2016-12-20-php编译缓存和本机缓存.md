---
title: 'php编译缓存和本机缓存'
layout: post
tags:
  - php
  - cache
category: php
---

# php编译缓存和本机缓存

### php生命周期

> Zend引擎必须从文件系统读取文件、扫描其词典和表达式、解析文件、创建要执行的计算机代码（称为Opcode），最后执行Opcode。每一次请求PHP脚本都会执行一遍以上步骤，如果PHP源代码没有变化，那么Opcode也不会变化，显然没有必要每次都重行生成Opcode，结合在Web中无所不在的缓存机制，我们可以把Opcode缓存下来，以后直接访问缓存的Opcode岂不是更快，启用Opcode缓存之后的流程图如下所

生命周期

### 什么是opcode

当解释器完成对脚本代码的分析后，便将它们生成可以直接运行的中间代码，也称为操作码（Operate Code，opcode）。Opcode cache的目地是避免重复编译，减少CPU和内存开销。下面是php.ini配置


```
opcache.memory_consumption=128
opcache.interned_strings_buffer=8
opcache.max_accelerated_files=4000
opcache.revalidate_freq=60
opcache.fast_shutdown=1
opcache.enable_cli=1
```

### 什么是apc

5.5以后就没有更新，是早期版本的缓存，主要实现opcode缓存和本地缓存（user data)操作，性能比zend opcode略差，但是支持user data本机数据缓存操作（类似memcache）

### 什么是apcu

5.6才能使用的扩展，zend opcode只是支持apc的代码编译缓存，不支持本机缓存操作。apcu支持本机数据缓存操作。可以使用zend opcode + apcu来实现apc缓存的两个功能，效率比apc高



* 目录
{:toc #cntNav}




